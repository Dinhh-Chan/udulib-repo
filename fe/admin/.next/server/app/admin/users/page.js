(()=>{var e={};e.id=733,e.ids=[733],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1589:(e,t,a)=>{"use strict";a.d(t,{SQ:()=>h,_2:()=>m,lp:()=>p,mB:()=>f,rI:()=>c,ty:()=>u});var s=a(5781),r=a(3072),n=a(217),i=a(2152),l=a(8108),o=a(3102),d=a(7401);let c=n.bL,u=n.l9;n.YJ,n.ZL,n.Pb,n.z6,r.forwardRef(({className:e,inset:t,children:a,...r},l)=>(0,s.jsxs)(n.ZP,{ref:l,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r,children:[a,(0,s.jsx)(i.A,{className:"ml-auto"})]})).displayName=n.ZP.displayName,r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.G5,{ref:a,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})).displayName=n.G5.displayName;let h=r.forwardRef(({className:e,sideOffset:t=4,...a},r)=>(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{ref:r,sideOffset:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));h.displayName=n.UC.displayName;let m=r.forwardRef(({className:e,inset:t,...a},r)=>(0,s.jsx)(n.q7,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...a}));m.displayName=n.q7.displayName,r.forwardRef(({className:e,children:t,checked:a,...r},i)=>(0,s.jsxs)(n.H_,{ref:i,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:a,...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),t]})).displayName=n.H_.displayName,r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(n.hN,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(o.A,{className:"h-2 w-2 fill-current"})})}),t]})).displayName=n.hN.displayName;let p=r.forwardRef(({className:e,inset:t,...a},r)=>(0,s.jsx)(n.JU,{ref:r,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...a}));p.displayName=n.JU.displayName;let f=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.wv,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t}));f.displayName=n.wv.displayName},1978:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>h,Es:()=>p,L3:()=>f,c7:()=>m,lG:()=>o,rr:()=>g,zM:()=>d});var s=a(5781),r=a(3072),n=a(6033),i=a(9252),l=a(7401);let o=n.bL,d=n.l9,c=n.ZL;n.bm;let u=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.hJ,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=n.hJ.displayName;let h=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(n.UC,{ref:r,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[t,(0,s.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));h.displayName=n.UC.displayName;let m=({className:e,...t})=>(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});m.displayName="DialogHeader";let p=({className:e,...t})=>(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});p.displayName="DialogFooter";let f=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.hE,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));f.displayName=n.hE.displayName;let g=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.VY,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",e),...t}));g.displayName=n.VY.displayName},2902:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2752).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4186:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(2752).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4784:(e,t,a)=>{"use strict";a.d(t,{Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>l});var s=a(5781),r=a(3072),n=a(7401);let i=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let l=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle",r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t})).displayName="CardDescription";let d=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},5612:(e,t,a)=>{Promise.resolve().then(a.bind(a,7166))},5646:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(1129).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/users/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/users/page.tsx","default")},5655:(e,t,a)=>{"use strict";function s(){return null}a.r(t),a.d(t,{default:()=>s})},5884:(e,t,a)=>{Promise.resolve().then(a.bind(a,5646))},7166:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var s=a(5781),r=a(3072),n=a(4784),i=a(4238),l=a(4132),o=a(9192),d=a(1589),c=a(9173),u=a(4186),h=a(2902),m=a(6909),p=a(4915);let f="http://localhost:8001/api/v1";class g{getAuthHeaders(){let e=localStorage.getItem("access_token"),t={"Content-Type":"application/json"};return e&&(t.Authorization=`Bearer ${e}`),console.log("API Headers:",t),t}handleAuthError(){localStorage.removeItem("user"),localStorage.removeItem("access_token"),p.oR.error("Phi\xean đăng nhập đ\xe3 hết hạn, vui l\xf2ng đăng nhập lại",{duration:3e3,position:"top-center"});let e=window.location.pathname,t=`/login?callbackUrl=${encodeURIComponent(e)}`;window.location.href=t}async handleResponse(e){if(console.log("Response status:",e.status),console.log("Response headers:",Object.fromEntries(e.headers.entries())),!e.ok){if(401===e.status)throw this.handleAuthError(),Error("Unauthorized");if(403===e.status)throw p.oR.error("Bạn kh\xf4ng c\xf3 quyền thực hiện h\xe0nh động n\xe0y",{duration:3e3,position:"top-center"}),Error("Forbidden");let t="Đ\xe3 xảy ra lỗi";try{let a=await e.json();console.log("Error response:",a),t=a.detail||a.message||t}catch{t=e.statusText||t}throw Error(t)}let t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():null}async get(e,t){let a=new URL(`${f}${e}`);t&&Object.entries(t).forEach(([e,t])=>{null!=t&&""!==t&&a.searchParams.append(e,t.toString())}),console.log("GET Request URL:",a.toString());try{let e=await fetch(a.toString(),{method:"GET",headers:this.getAuthHeaders()});return await this.handleResponse(e)}catch(t){if(console.error(`GET ${e} failed:`,t),t instanceof TypeError&&"Failed to fetch"===t.message)throw p.oR.error("Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra kết nối mạng."),Error("Network Error");throw t}}async post(e,t){let a=`${f}${e}`;console.log("POST Request URL:",a),console.log("POST Request Data:",t);try{let e=await fetch(a,{method:"POST",headers:this.getAuthHeaders(),body:t?JSON.stringify(t):void 0});return await this.handleResponse(e)}catch(t){if(console.error(`POST ${e} failed:`,t),t instanceof TypeError&&"Failed to fetch"===t.message)throw p.oR.error("Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra kết nối mạng."),Error("Network Error");throw t}}async put(e,t){let a=`${f}${e}`;if(console.log("PUT Request URL:",a),console.log("PUT Request Data:",t),console.log("API_URL:",f),!f)throw console.error("API_URL is not defined in environment variables"),p.oR.error("Cấu h\xecnh API kh\xf4ng đ\xfang. Vui l\xf2ng li\xean hệ quản trị vi\xean."),Error("API Configuration Error");try{let e=await fetch(a,{method:"PUT",headers:this.getAuthHeaders(),body:t?JSON.stringify(t):void 0});return await this.handleResponse(e)}catch(s){if(console.error(`PUT ${e} failed:`,s),s instanceof TypeError&&"Failed to fetch"===s.message)throw console.error("Network error details:",{url:a,headers:this.getAuthHeaders(),data:t}),p.oR.error("Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra kết nối mạng hoặc cấu h\xecnh API."),Error("Network Error");throw s}}async patch(e,t){let a=`${f}${e}`;console.log("PATCH Request URL:",a);try{let e=await fetch(a,{method:"PATCH",headers:this.getAuthHeaders(),body:t?JSON.stringify(t):void 0});return await this.handleResponse(e)}catch(t){if(console.error(`PATCH ${e} failed:`,t),t instanceof TypeError&&"Failed to fetch"===t.message)throw p.oR.error("Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra kết nối mạng."),Error("Network Error");throw t}}async delete(e){let t=`${f}${e}`;console.log("DELETE Request URL:",t);try{let e=await fetch(t,{method:"DELETE",headers:this.getAuthHeaders()});await this.handleResponse(e)}catch(t){if(console.error(`DELETE ${e} failed:`,t),t instanceof TypeError&&"Failed to fetch"===t.message)throw p.oR.error("Kh\xf4ng thể kết nối đến server. Vui l\xf2ng kiểm tra kết nối mạng."),Error("Network Error");throw t}}isAuthenticated(){return!!localStorage.getItem("access_token")}getCurrentUser(){try{let e=localStorage.getItem("user");return e?JSON.parse(e):null}catch{return null}}async testConnection(){try{return(await fetch(`${f}/health`,{method:"GET",headers:{"Content-Type":"application/json"}})).ok}catch{return!1}}}let x=new g;async function j(e){try{return await x.get("/users",e)}catch(e){return e instanceof Error&&"Unauthorized"!==e.message&&p.oR.error("Kh\xf4ng thể lấy danh s\xe1ch người d\xf9ng"),[]}}async function v(e){try{return await x.post("/users",e),p.oR.success("Tạo người d\xf9ng mới th\xe0nh c\xf4ng"),!0}catch(e){return e instanceof Error&&"Unauthorized"!==e.message&&"Forbidden"!==e.message&&p.oR.error(e.message||"Kh\xf4ng thể tạo người d\xf9ng mới"),!1}}async function y(e,t){try{return await x.put(`/users/${e}`,t),p.oR.success("Cập nhật th\xf4ng tin người d\xf9ng th\xe0nh c\xf4ng"),!0}catch(e){return e instanceof Error&&"Unauthorized"!==e.message&&"Forbidden"!==e.message&&p.oR.error(e.message||"Kh\xf4ng thể cập nhật th\xf4ng tin người d\xf9ng"),!1}}async function b(e){try{return await x.delete(`/users/${e}`),p.oR.success("X\xf3a người d\xf9ng th\xe0nh c\xf4ng"),!0}catch(e){return e instanceof Error&&"Unauthorized"!==e.message&&"Forbidden"!==e.message&&p.oR.error(e.message||"Kh\xf4ng thể x\xf3a người d\xf9ng"),!1}}var N=a(1978),w=a(9839),R=a(8414);function _({open:e,onOpenChange:t,onSuccess:a}){let[n,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)({username:"",email:"",password:"",full_name:"",role:"student",university_id:""}),u=async e=>{e.preventDefault(),o(!0);try{await v(d)&&(a(),t(!1),c({username:"",email:"",password:"",full_name:"",role:"student",university_id:""}))}catch(e){console.error("Error creating user:",e)}finally{o(!1)}};return(0,s.jsx)(N.lG,{open:e,onOpenChange:t,children:(0,s.jsxs)(N.Cf,{className:"max-w-md",children:[(0,s.jsx)(N.c7,{children:(0,s.jsx)(N.L3,{children:"Th\xeam người d\xf9ng mới"})}),(0,s.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"username",children:"T\xean đăng nhập"}),(0,s.jsx)(l.p,{id:"username",value:d.username,onChange:e=>c({...d,username:e.target.value}),placeholder:"Nhập t\xean đăng nhập",required:!0,disabled:n})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"email",children:"Email"}),(0,s.jsx)(l.p,{id:"email",type:"email",value:d.email,onChange:e=>c({...d,email:e.target.value}),placeholder:"Nhập địa chỉ email",required:!0,disabled:n})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"password",children:"Mật khẩu"}),(0,s.jsx)(l.p,{id:"password",type:"password",value:d.password,onChange:e=>c({...d,password:e.target.value}),placeholder:"Nhập mật khẩu",required:!0,disabled:n})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"full_name",children:"Họ t\xean"}),(0,s.jsx)(l.p,{id:"full_name",value:d.full_name,onChange:e=>c({...d,full_name:e.target.value}),placeholder:"Nhập họ v\xe0 t\xean",required:!0,disabled:n})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"role",children:"Vai tr\xf2"}),(0,s.jsxs)(R.Select,{value:d.role,onValueChange:e=>c({...d,role:e}),disabled:n,children:[(0,s.jsx)(R.SelectTrigger,{children:(0,s.jsx)(R.SelectValue,{placeholder:"Chọn vai tr\xf2"})}),(0,s.jsxs)(R.SelectContent,{children:[(0,s.jsx)(R.SelectItem,{value:"admin",children:"Quản trị vi\xean"}),(0,s.jsx)(R.SelectItem,{value:"teacher",children:"Giảng vi\xean"}),(0,s.jsx)(R.SelectItem,{value:"student",children:"Sinh vi\xean"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"university_id",children:"M\xe3 sinh vi\xean/Giảng vi\xean"}),(0,s.jsx)(l.p,{id:"university_id",value:d.university_id,onChange:e=>c({...d,university_id:e.target.value}),placeholder:"Nhập m\xe3 số (t\xf9y chọn)",disabled:n})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>{t(!1),c({username:"",email:"",password:"",full_name:"",role:"student",university_id:""})},disabled:n,children:"Hủy"}),(0,s.jsx)(i.$,{type:"submit",disabled:n,children:n?"Đang th\xeam...":"Th\xeam người d\xf9ng"})]})]})]})})}var C=a(7990),k=a(7401);let E=(0,C.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),S=r.forwardRef(({className:e,variant:t,...a},r)=>(0,s.jsx)("div",{ref:r,role:"alert",className:(0,k.cn)(E({variant:t}),e),...a}));S.displayName="Alert",r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("h5",{ref:a,className:(0,k.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let T=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{ref:a,className:(0,k.cn)("text-sm [&_p]:leading-relaxed",e),...t}));function A({user:e,open:t,onOpenChange:a,onSuccess:n}){let[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),{user:h}=Object(function(){var e=Error("Cannot find module '@/contexts/auth-context'");throw e.code="MODULE_NOT_FOUND",e}())(),[m,f]=(0,r.useState)({username:e.username,email:e.email,full_name:e.full_name,role:e.role,status:e.status,university_id:e.university_id||""}),g=()=>!!h&&("admin"===h.role?h.user_id!==e.user_id:h.user_id===e.user_id),x=()=>!!h&&"admin"===h.role&&h.user_id!==e.user_id,j=()=>!!h&&"admin"===h.role&&h.user_id!==e.user_id,v=async t=>{t.preventDefault(),d(!0),u("");try{if(!g()){u("Bạn kh\xf4ng c\xf3 quyền chỉnh sửa người d\xf9ng n\xe0y");return}let t={username:m.username,email:m.email,full_name:m.full_name,university_id:m.university_id};x()&&(t.role=m.role),j()&&(t.status=m.status),console.log("Updating user with data:",t),await y(e.user_id,t)&&(n(),a(!1),p.oR.success("Cập nhật th\xf4ng tin th\xe0nh c\xf4ng"))}catch(e){console.error("Error updating user:",e),e instanceof Error&&(e.message.includes("403")||e.message.includes("Forbidden")?u("Bạn kh\xf4ng c\xf3 quyền thực hiện h\xe0nh động n\xe0y"):e.message.includes("500")?u("Lỗi server. Vui l\xf2ng thử lại sau hoặc li\xean hệ quản trị vi\xean"):e.message.includes("Network Error")?u("Lỗi kết nối. Vui l\xf2ng kiểm tra mạng v\xe0 thử lại"):u(e.message||"C\xf3 lỗi xảy ra khi cập nhật th\xf4ng tin"))}finally{d(!1)}};return g()?(0,s.jsx)(N.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(N.Cf,{className:"max-w-md",children:[(0,s.jsx)(N.c7,{children:(0,s.jsx)(N.L3,{children:"Chỉnh sửa th\xf4ng tin người d\xf9ng"})}),c&&(0,s.jsx)(S,{variant:"destructive",children:(0,s.jsx)(T,{children:c})}),(0,s.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"username",children:"T\xean đăng nhập"}),(0,s.jsx)(l.p,{id:"username",value:m.username,onChange:e=>f({...m,username:e.target.value}),required:!0,disabled:o})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"email",children:"Email"}),(0,s.jsx)(l.p,{id:"email",type:"email",value:m.email,onChange:e=>f({...m,email:e.target.value}),required:!0,disabled:o})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"full_name",children:"Họ t\xean"}),(0,s.jsx)(l.p,{id:"full_name",value:m.full_name,onChange:e=>f({...m,full_name:e.target.value}),required:!0,disabled:o})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"role",children:"Vai tr\xf2"}),(0,s.jsxs)(R.Select,{value:m.role,onValueChange:e=>f({...m,role:e}),disabled:o||!x(),children:[(0,s.jsx)(R.SelectTrigger,{children:(0,s.jsx)(R.SelectValue,{placeholder:"Chọn vai tr\xf2"})}),(0,s.jsxs)(R.SelectContent,{children:[(0,s.jsx)(R.SelectItem,{value:"admin",children:"Quản trị vi\xean"}),(0,s.jsx)(R.SelectItem,{value:"teacher",children:"Giảng vi\xean"}),(0,s.jsx)(R.SelectItem,{value:"student",children:"Sinh vi\xean"})]})]}),!x()&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chỉ admin mới c\xf3 thể thay đổi vai tr\xf2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"status",children:"Trạng th\xe1i"}),(0,s.jsxs)(R.Select,{value:m.status,onValueChange:e=>f({...m,status:e}),disabled:o||!j(),children:[(0,s.jsx)(R.SelectTrigger,{children:(0,s.jsx)(R.SelectValue,{placeholder:"Chọn trạng th\xe1i"})}),(0,s.jsxs)(R.SelectContent,{children:[(0,s.jsx)(R.SelectItem,{value:"active",children:"Hoạt động"}),(0,s.jsx)(R.SelectItem,{value:"inactive",children:"Kh\xf4ng hoạt động"}),(0,s.jsx)(R.SelectItem,{value:"banned",children:"Bị cấm"})]})]}),!j()&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chỉ admin mới c\xf3 thể thay đổi trạng th\xe1i"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.J,{htmlFor:"university_id",children:"M\xe3 sinh vi\xean/Giảng vi\xean"}),(0,s.jsx)(l.p,{id:"university_id",value:m.university_id,onChange:e=>f({...m,university_id:e.target.value}),disabled:o})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:o,children:"Hủy"}),(0,s.jsx)(i.$,{type:"submit",disabled:o,children:o?"Đang cập nhật...":"Cập nhật"})]})]})]})}):(0,s.jsx)(N.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(N.Cf,{className:"max-w-md",children:[(0,s.jsx)(N.c7,{children:(0,s.jsx)(N.L3,{children:"Kh\xf4ng c\xf3 quyền truy cập"})}),(0,s.jsx)(S,{children:(0,s.jsx)(T,{children:"Bạn kh\xf4ng c\xf3 quyền chỉnh sửa th\xf4ng tin người d\xf9ng n\xe0y."})}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(i.$,{onClick:()=>a(!1),children:"Đ\xf3ng"})})]})})}function P(){let[e,t]=(0,r.useState)([]),[a,f]=(0,r.useState)(!0),[g,x]=(0,r.useState)(""),[v,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),R=async()=>{f(!0);try{let e=await j({search:g});t(e)}catch(e){console.error("Error loading users:",e),p.oR.error("Kh\xf4ng thể tải danh s\xe1ch người d\xf9ng")}finally{f(!1)}},C=async e=>{try{window.confirm("Bạn c\xf3 chắc chắn muốn x\xf3a người d\xf9ng n\xe0y?")&&(await b(e),p.oR.success("X\xf3a người d\xf9ng th\xe0nh c\xf4ng"),R())}catch(e){console.error("Error deleting user:",e),p.oR.error("Kh\xf4ng thể x\xf3a người d\xf9ng")}},E=e=>(0,s.jsx)(c.E,{className:`${{admin:"bg-red-500",teacher:"bg-blue-500",student:"bg-green-500"}[e]} text-white`,children:"admin"===e?"Quản trị vi\xean":"teacher"===e?"Giảng vi\xean":"Sinh vi\xean"}),S=e=>(0,s.jsx)(c.E,{className:`${{active:"bg-green-500",inactive:"bg-yellow-500",banned:"bg-red-500"}[e]} text-white`,children:"active"===e?"Hoạt động":"inactive"===e?"Kh\xf4ng hoạt động":"Bị cấm"});return a?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Đang tải..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Quản l\xfd người d\xf9ng"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Th\xeam, sửa, x\xf3a v\xe0 quản l\xfd t\xe0i khoản người d\xf9ng trong hệ thống"})]}),(0,s.jsxs)(i.$,{onClick:()=>y(!0),children:[(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Th\xeam người d\xf9ng"]})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(n.ZB,{children:"Danh s\xe1ch người d\xf9ng"}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(l.p,{placeholder:"T\xecm kiếm...",className:"pl-8",value:g,onChange:e=>x(e.target.value)})]})})]})}),(0,s.jsx)(n.Wu,{children:0===e.length?(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"Kh\xf4ng t\xecm thấy người d\xf9ng n\xe0o"}):(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"ID"}),(0,s.jsx)(o.nd,{children:"T\xean đăng nhập"}),(0,s.jsx)(o.nd,{children:"Email"}),(0,s.jsx)(o.nd,{children:"Họ t\xean"}),(0,s.jsx)(o.nd,{children:"Vai tr\xf2"}),(0,s.jsx)(o.nd,{children:"Trạng th\xe1i"}),(0,s.jsx)(o.nd,{children:"Ng\xe0y tạo"}),(0,s.jsx)(o.nd,{children:"Thao t\xe1c"})]})}),(0,s.jsx)(o.BF,{children:e.map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nA,{children:e.user_id}),(0,s.jsx)(o.nA,{children:e.username}),(0,s.jsx)(o.nA,{children:e.email}),(0,s.jsx)(o.nA,{children:e.full_name}),(0,s.jsx)(o.nA,{children:E(e.role)}),(0,s.jsx)(o.nA,{children:S(e.status)}),(0,s.jsx)(o.nA,{children:(0,k.Y)(e.created_at)}),(0,s.jsx)(o.nA,{children:(0,s.jsxs)(d.rI,{children:[(0,s.jsx)(d.ty,{asChild:!0,children:(0,s.jsx)(i.$,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(d.SQ,{align:"end",children:[(0,s.jsx)(d._2,{onClick:()=>w(e),children:"Chỉnh sửa"}),(0,s.jsx)(d._2,{className:"text-red-600",onClick:()=>C(e.user_id),children:"X\xf3a"})]})]})})]},e.user_id))})]})})]}),(0,s.jsx)(_,{open:v,onOpenChange:y,onSuccess:R}),N&&(0,s.jsx)(A,{user:N,open:!!N,onOpenChange:e=>!e&&w(null),onSuccess:R})]})}T.displayName="AlertDescription",function(){var e=Error("Cannot find module '@/contexts/auth-context'");throw e.code="MODULE_NOT_FOUND",e}()},7196:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=a(7025),r=a(8198),n=a(2576),i=a.n(n),l=a(5239),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d={children:["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,5646)),"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/users/page.tsx"]}]},{loading:[()=>Promise.resolve().then(a.bind(a,5655)),"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/users/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,254)),"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,9654)),"/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/loading.tsx"]}]},{"not-found":[()=>Promise.resolve().then(a.t.bind(a,4540,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,3117,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,6874,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/dinh-tran/Documents/project/udulib-repo/fe/admin/app/admin/users/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8414:(e,t,a)=>{"use strict";a.d(t,{Select:()=>c,SelectContent:()=>f,SelectItem:()=>g,SelectTrigger:()=>h,SelectValue:()=>u});var s=a(5781),r=a(3072),n=a(5332),i=a(1776),l=a(8613),o=a(8108),d=a(7401);let c=n.bL;n.YJ;let u=n.WT,h=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(n.l9,{ref:r,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[t,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]}));h.displayName=n.l9.displayName;let m=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.PP,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})}));m.displayName=n.PP.displayName;let p=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.wn,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})}));p.displayName=n.wn.displayName;let f=r.forwardRef(({className:e,children:t,position:a="popper",...r},i)=>(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{ref:i,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...r,children:[(0,s.jsx)(m,{}),(0,s.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,s.jsx)(p,{})]})}));f.displayName=n.UC.displayName,r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.JU,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=n.JU.displayName;let g=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(n.q7,{ref:r,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})}),(0,s.jsx)(n.p4,{children:t})]}));g.displayName=n.q7.displayName,r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(n.wv,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.wv.displayName},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9173:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(5781);a(3072);var r=a(7990),n=a(7401);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...a}){return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:t}),e),...a})}},9192:(e,t,a)=>{"use strict";a.d(t,{A0:()=>l,BF:()=>o,Hj:()=>d,XI:()=>i,nA:()=>u,nd:()=>c});var s=a(5781),r=a(3072),n=a(7401);let i=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:a,className:(0,n.cn)("w-full caption-bottom text-sm",e),...t})}));i.displayName="Table";let l=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("thead",{ref:a,className:(0,n.cn)("[&_tr]:border-b",e),...t}));l.displayName="TableHeader";let o=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("tbody",{ref:a,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("tfoot",{ref:a,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let d=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("tr",{ref:a,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("th",{ref:a,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let u=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("td",{ref:a,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",r.forwardRef(({className:e,...t},a)=>(0,s.jsx)("caption",{ref:a,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9839:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var s=a(5781),r=a(3072),n=a(9151),i=r.forwardRef((e,t)=>(0,s.jsx)(n.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=a(7990),o=a(7401);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef(({className:e,...t},a)=>(0,s.jsx)(i,{ref:a,className:(0,o.cn)(d(),e),...t}));c.displayName=i.displayName}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[273,959,910,667,936],()=>a(7196));module.exports=s})();